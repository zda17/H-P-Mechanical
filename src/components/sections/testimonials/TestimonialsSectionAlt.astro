---
import ReviewComponent from "@components/ui/blocks/ReviewComponent.astro";

const testimonials = [
  {
    content: "Wonderful Service! Came out after hours as soon as we called about our AC going out. Found the issue and offered us a window unit until they could fix it the next day! Would definitely use again.",
    author: "Amanda Spruce",
  },
  {
    content:
      "Outstanding service from start to finish. The technician arrived on time, thoroughly inspected our system, and clearly explained all the options available. Their honest approach and fair pricing made the decision easy. We're extremely satisfied with the quality of work and professionalism shown throughout the entire process.",
    author: "Jason Miller",
  },
  {
    content:
      "Excellent experience with H & P Mechanical. They responded quickly to our service call and provided a comprehensive maintenance check. The team was knowledgeable, respectful of our home, and completed the work efficiently. We feel confident in their expertise and will definitely use their services again.",
    author: "Cheryl Whaley",
  },
  {
    content:
      "We needed our AC system replaced during a heatwave and H & P Mechanical went above and beyond to help us. They worked late into the evening to ensure we had cooling restored the same day. The installation was done professionally, and they took time to explain the new system's features. Truly exceptional service when we needed it most.",
    author: "David Moore ",
  },
  {
    content:
      "Had an emergency AC breakdown during the hottest week of summer. H & P Mechanical responded within hours, quickly diagnosed the issue, and had the necessary parts available. They completed the repair the same day with fair, transparent pricing. The technician was professional, courteous, and clearly explained what was wrong and how they fixed it.",
    author: "Jennifer Brown",
  },
  {
    content:
      "We've been using H & P Mechanical for all our HVAC needs for several years now. Their team consistently demonstrates professionalism, punctuality, and attention to detail. Recently had them install a new heating system and the entire process was seamless. From initial consultation to final installation, they exceeded our expectations.",
    author: "Mark Williams",
  }
];
---
<!-- Main div that wraps the testimonials section -->
<section
  class="mx-auto max-w-[85rem] px-4 py-10 sm:px-6 lg:px-8 lg:py-14 2xl:max-w-full"
  id="testimonials"
>
  <!-- Title of the testimonials section -->
  <div class="mb-6 w-full lg:w-3/4 max-w-2xl sm:mb-10 md:mb-16 lg:w-1/2">
    <h2
      class="text-balance text-2xl font-bold text-neutral-800 dark:text-neutral-200 sm:text-3xl text-center lg:text-left lg:text-4xl"
    >
      What Our Customers Say
    </h2>
    <ReviewComponent starCount={4} rating="4.9" reviews=`From <span class="font-bold">100+</span> Reviews` />

  </div>

  <div class="grid gap-6 sm:grid-cols-2 lg:grid-cols-3" id="testimonials-grid">
    {
      testimonials.map((testimonial, index) => (
        <div 
          class={`flex h-auto ${index >= 3 ? 'hidden testimonials-hidden' : ''}`}
          data-testimonial-index={index}
        >
          <div class="flex flex-col rounded-xl bg-neutral-50 dark:bg-neutral-700">
            <div class="flex-auto p-4 md:p-6">
              <p class="text-pretty text-base italic text-neutral-600 dark:text-neutral-300 md:text-lg">
                {testimonial.content}
              </p>
            </div>

            <div class="rounded-b-xl bg-neutral-300/30 p-4 dark:bg-neutral-900/30 md:px-7">
              <div class="flex items-center">
                <div class="ms-3 grow">
                  <p class="text-sm font-bold text-neutral-800 dark:text-neutral-200 sm:text-base">
                    {testimonial.author}
                  </p>
                </div>
              </div>
            </div>
          </div>
        </div>
      ))
    }
  </div>

  <!-- See More Button -->
  {testimonials.length > 3 && (
    <div class="mt-8 text-center">
      <button
        id="see-more-testimonials"
        class="see-more-btn rounded-lg border-none px-6 py-3 text-sm font-bold text-white transition-colors duration-200"
      >
        See More Reviews
      </button>
    </div>
  )}
</section>

<style>
  .see-more-btn {
    background-color: #0f172a !important;
    border: none !important;
  }
  .see-more-btn:hover {
    background-color: #1e293b !important;
  }
</style>

<script>
  const seeMoreBtn = document.getElementById('see-more-testimonials');
  const hiddenTestimonials = document.querySelectorAll('.testimonials-hidden');
  let isExpanded = false;

  if (seeMoreBtn && hiddenTestimonials.length > 0) {
    seeMoreBtn.addEventListener('click', () => {
      hiddenTestimonials.forEach((testimonial) => {
        if (isExpanded) {
          testimonial.classList.add('hidden');
        } else {
          testimonial.classList.remove('hidden');
        }
      });
      
      isExpanded = !isExpanded;
      seeMoreBtn.textContent = isExpanded ? 'See Less Reviews' : 'See More Reviews';
    });
  }
</script>
