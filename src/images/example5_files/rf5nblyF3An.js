;/*FB_PKG_DELIM*/

__d("CometUFICommentListRenderer_feedback.graphql",[],(function(t,n,r,o,a,i){"use strict";var e={argumentDefinitions:[{defaultValue:!0,kind:"LocalArgument",name:"canShowSeenState"},{kind:"RootArgument",name:"feedLocation"},{kind:"RootArgument",name:"feedbackSource"},{defaultValue:!0,kind:"LocalArgument",name:"shouldShowComments"}],kind:"Fragment",metadata:null,name:"CometUFICommentListRenderer_feedback",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:[{kind:"Variable",name:"feedback_source_integer",variableName:"feedbackSource"}],kind:"ScalarField",name:"is_eligible_for_enhanced_comment_updates",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_synced_qa_post",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"subscription_target_id",storageKey:null},{alias:null,args:null,concreteType:"Video",kind:"LinkedField",name:"associated_video",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"broadcast_is_ama_enabled",storageKey:null}],storageKey:null},{condition:"shouldShowComments",kind:"Condition",passingValue:!0,selections:[{alias:null,args:[{kind:"Variable",name:"location",variableName:"feedLocation"},{kind:"Literal",name:"supported",value:"4AxN2k"}],concreteType:null,kind:"LinkedField",name:"comment_list_renderer",plural:!1,selections:[{kind:"InlineFragment",selections:[{args:null,documentName:"CometUFICommentListRenderer_feedback",fragmentName:"CometUFICommentListRendererForCommentsAPI_renderer",fragmentPropName:"renderer",kind:"ModuleImport"}],type:"XFBCommentListRendererForCommentsAPI",abstractKey:null},{kind:"InlineFragment",selections:[{args:null,documentName:"CometUFICommentListRenderer_feedback",fragmentName:"CometUFICommentListRendererForCommentsAPIPermalink_renderer",fragmentPropName:"renderer",kind:"ModuleImport"}],type:"XFBCommentListRendererForCommentsAPIPermalink",abstractKey:null},{kind:"InlineFragment",selections:[{args:null,documentName:"CometUFICommentListRenderer_feedback",fragmentName:"CometUFICommentListRendererForCommentsAPIMediaViewer_renderer",fragmentPropName:"renderer",kind:"ModuleImport"}],type:"XFBCommentListRendererForCommentsAPIMediaViewer",abstractKey:null},{kind:"InlineFragment",selections:[{args:null,documentName:"CometUFICommentListRenderer_feedback",fragmentName:"CometUFICommentListRendererForCommentsAPITahoe_renderer",fragmentPropName:"renderer",kind:"ModuleImport"}],type:"XFBCommentListRendererForCommentsAPITahoe",abstractKey:null},{kind:"InlineFragment",selections:[{args:null,documentName:"CometUFICommentListRenderer_feedback",fragmentName:"CometUFICommentListRendererForCommentsAPITahoeWithLiveVOD_renderer",fragmentPropName:"renderer",kind:"ModuleImport"}],type:"XFBCommentListRendererForCommentsAPITahoeWithLiveVOD",abstractKey:null},{kind:"InlineFragment",selections:[{args:null,documentName:"CometUFICommentListRenderer_feedback",fragmentName:"CometUFICommentListRendererForCommentsAPIWorkplaceKnowledgeNote_renderer",fragmentPropName:"renderer",kind:"ModuleImport"}],type:"XFBCommentListRendererForCommentsAPIWorkplaceKnowledgeNote",abstractKey:null},{kind:"InlineFragment",selections:[{args:null,documentName:"CometUFICommentListRenderer_feedback",fragmentName:"CometUFICommentListRendererForCommentsAPIBizInbox_renderer",fragmentPropName:"renderer",kind:"ModuleImport"}],type:"XFBCommentListRendererForCommentsAPIBizInbox",abstractKey:null},{kind:"InlineFragment",selections:[{args:null,documentName:"CometUFICommentListRenderer_feedback",fragmentName:"CometUFICommentListRendererForMediaViewerReply_renderer",fragmentPropName:"renderer",kind:"ModuleImport"}],type:"XFBCommentListRendererForMediaViewerReply",abstractKey:null}],storageKey:null}]}],type:"Feedback",abstractKey:null};a.exports=e}),null);
__d("CometUFIReparentedCommentIDsContext.react",["react","react-compiler-runtime"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react")),u=e,c=u.createContext,d=u.useCallback,m=u.useMemo,p=u.useState,_=c({addReparentedCommentIds:function(){},reparentedToDeletedCommentsMap:new Map});function f(e){var t=o("react-compiler-runtime").c(7),n=e.children,r;t[0]===Symbol.for("react.memo_cache_sentinel")?(r=new Map,t[0]=r):r=t[0];var a=p(r),i=a[0],l=a[1],u;t[1]===Symbol.for("react.memo_cache_sentinel")?(u=function(t){l(function(e){return t.forEach(function(t,n){e.set(n,t)}),e})},t[1]=u):u=t[1];var c=u,d;t[2]!==i?(d={addReparentedCommentIds:c,reparentedToDeletedCommentsMap:i},t[2]=i,t[3]=d):d=t[3];var m=d,f;return t[4]!==n||t[5]!==m?(f=s.jsx(_.Provider,{value:m,children:n}),t[4]=n,t[5]=m,t[6]=f):f=t[6],f}l.CometUFIReparentedCommentIDsContext=_,l.CometUFIReparentedCommentIDsContextProvider=f}),98);
__d("CometUFICommentListRenderer.react",["CometAdPreviewContext","CometRelay","CometUFICommentListComposerProvider.react","CometUFICommentListLayoutContext","CometUFICommentListRenderer_feedback.graphql","CometUFIFunnelLoggerConstants","CometUFIQPLInstanceKeyContext","CometUFIReparentedCommentIDsContext.react","ErrorGuard","FBLogger","UFI2RealtimeContainer.react","mergeRefs","react","requireDeferred","useBoolean","useCometUFICodedErrorDialog","useTriggeredStoryCTAHandler"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c=u||(u=o("react")),d=u,m=d.useCallback,p=d.useContext,_=d.useMemo,f=d.useRef,g=d.useState,h=r("requireDeferred")("CometUFIDeleteCommentSubscription").__setRef("CometUFICommentListRenderer.react"),y=r("requireDeferred")("CometUFIEditCommentSubscription").__setRef("CometUFICommentListRenderer.react"),C=r("requireDeferred")("CometUFIFeedbackCommentReactSubscription").__setRef("CometUFICommentListRenderer.react"),b=r("requireDeferred")("CometUFIFunnelLogger").__setRef("CometUFICommentListRenderer.react"),v=r("requireDeferred")("CometUFIWorkQACommentTypeUpdateSubscription").__setRef("CometUFICommentListRenderer.react");function S(t){var a=t.feedback,i=t.feedbackSource,l=t.feedLocation,u=t.focusCommentID,d=t.listRef,S=t.narrow,R=t.onActorSelected,L=t.onCommitCommentCreate,E=t.socialMarketplace,k=t.storyRenderLocation,I=o("CometRelay").useFragment(e!==void 0?e:e=n("CometUFICommentListRenderer_feedback.graphql"),a),T=o("CometAdPreviewContext").useCometAdPreviewContext(),D=f(null),x=o("CometRelay").useRelayEnvironment(),$=r("useTriggeredStoryCTAHandler")(),P=$[0],N=g(null),M=N[0],w=N[1],A=g(null),F=A[0],O=A[1],B=r("useBoolean")(!1),W=B.setTrue,q=B.value,U=r("useCometUFICodedErrorDialog")(),V=U.errorDialog,H=U.setError,G=p(o("CometUFIReparentedCommentIDsContext.react").CometUFIReparentedCommentIDsContext),z=G.addReparentedCommentIds,j=I==null?void 0:I.id,K=I==null?void 0:I.subscription_target_id,Q=m(function(){var e;if(j==null||K==null)return null;var t=!1,n=[],o={dispose:function(){t=!0,n.forEach(function(e){return(s||(s=r("ErrorGuard"))).applyWithGuard(e,null,[])})}};return C.onReady(function(e){if(!t){var r=e.subscribe(x,{top_level_feedback_id:j},!1,!0);n.push(r.dispose)}}),I&&I.is_eligible_for_enhanced_comment_updates===!0&&!((e=I.associated_video)!=null&&e.broadcast_is_ama_enabled)&&(h.onReady(function(e){if(!t){var r=e.subscribe({addReparentedCommentIds:z,environment:x,feedbackSource:i,topLevelFeedbackID:j});n.push(r.dispose)}}),y.onReady(function(e){if(!t){var r=e.subscribe({environment:x,topLevelFeedbackID:j});n.push(r.dispose)}})),I&&I.is_synced_qa_post===!0&&v.onReady(function(e){if(!t){var r=e.subscribe({environment:x,feedbackID:j});n.push(r.dispose)}}),o},[x,I,j,i,K]),X=p(r("CometUFIQPLInstanceKeyContext")),Y=m(function(e){b.onReady(function(e){return e.addPoint(X,o("CometUFIFunnelLoggerConstants").CometUFIFunnelLoggerEvents.COMMENT_EDIT_ERROR)}),H(e)},[X,H]),J=g(function(){return new Set}),Z=J[0],ee=J[1],te=g(function(){return new Set}),ne=te[0],re=te[1],oe=m(function(e){var t;if(e!=null){var n=(t=e.node)==null?void 0:t.id;if(n==null){r("FBLogger")("ufi2").mustfix("Could not discern an `id` having received a realtime comment. Realtime comment handling might be broken. Investigate immediately.");return}re(function(e){return new Set(e).add(n)})}},[]),ae=m(function(){P("COMMENT_BUTTON_TAP")},[P]),ie=_(function(){return r("mergeRefs")(d,D)},[d]),le=_(function(){return{narrow:S}},[S]);if(j==null)return r("FBLogger")("ufi2").mustfix("No id on feedback when fetching from relay story in CometUFICommentListRenderer, this indicates relays store/environment has been bonkered some how"),null;var se=I==null?void 0:I.comment_list_renderer,ue=c.jsx(o("CometRelay").MatchContainer,{match:se,props:{editingCommentID:M,feedbackSource:i,feedLocation:l,focusCommentID:u,handleCreateCommentProps:{onCommit:L,setError:H,setLocallyComposedCommentIds:ee},listRef:ie,locallyComposedCommentIds:Z,onActorSelected:R,onComposerFocusCallback:ae,onEditCommentError:Y,onRealtimeCommentReceived:oe,onTranslateAllClick:W,realtimeCommentIds:ne,renderedTranslationCommentID:F,renderer:se,setEditingCommentID:w,setRenderedTranslationCommentID:O,shouldRequestTranslationForAllComments:q,socialMarketplace:E===!0,storyRenderLocation:k,useDefaultActor:!1}});return T===!0?null:c.jsxs(r("UFI2RealtimeContainer.react"),{subscribe:Q,children:[c.jsx(o("CometUFIReparentedCommentIDsContext.react").CometUFIReparentedCommentIDsContextProvider,{children:c.jsx(r("CometUFICommentListComposerProvider.react"),{children:c.jsx(r("CometUFICommentListLayoutContext").Provider,{value:le,children:ue})})}),V]})}S.displayName=S.name+" [from "+i.id+"]";var R=c.memo(S);l.default=R}),98);
__d("useCometUFISubscriptionManager",["FBLogger","JSScheduler","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=e||(e=o("react")),c=u.useCallback,d=u.useRef;function m(){var e=o("react-compiler-runtime").c(6),t;e[0]===Symbol.for("react.memo_cache_sentinel")?(t=new Set,e[0]=t):t=e[0];var n=d(t),a;e[1]===Symbol.for("react.memo_cache_sentinel")?(a=new Set,e[1]=a):a=e[1];var i=d(a),l=d(!1),u;e[2]===Symbol.for("react.memo_cache_sentinel")?(u=function(t){return n.current.add(t),l.current&&t.subscribe(),{dispose:function(){t.unsubscribe(),n.current.delete(t)}}},e[2]=u):u=e[2];var c=u,m;e[3]===Symbol.for("react.memo_cache_sentinel")?(m=function(){l.current||(l.current=!0,n.current.forEach(function(e){var t=(s||(s=o("JSScheduler"))).scheduleSpeculativeCallback(function(){l.current?(i.current.delete(t),e.subscribe()):r("FBLogger")("ufi2").mustfix("Scheduled callback to activate subscription was not canceled")});i.current.add(t)}))},e[3]=m):m=e[3];var f=m,g;e[4]===Symbol.for("react.memo_cache_sentinel")?(g=function(){l.current&&(l.current=!1,n.current.forEach(_),i.current.forEach(p),i.current.clear())},e[4]=g):g=e[4];var h=g,y;return e[5]===Symbol.for("react.memo_cache_sentinel")?(y=[c,f,h],e[5]=y):y=e[5],y}function p(e){return(s||(s=o("JSScheduler"))).cancelCallback(e)}function _(e){return e.unsubscribe()}l.default=m}),98);
__d("CometUFIRealtimeRoot.react",["UFI2RealtimeContext","react","react-compiler-runtime","useCometUFISubscriptionManager"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react")),u=e.useEffect;function c(e){var t=o("react-compiler-runtime").c(8),n=e.children,a=e.enabled,i=a===void 0?!0:a,l=r("useCometUFISubscriptionManager")(),c=l[0],d=l[1],m=l[2],p,_;t[0]!==i||t[1]!==d||t[2]!==m?(p=function(){if(i)return d(),(function(){m()})},_=[i,d,m],t[0]=i,t[1]=d,t[2]=m,t[3]=p,t[4]=_):(p=t[3],_=t[4]),u(p,_);var f;return t[5]!==c||t[6]!==n?(f=s.jsx(r("UFI2RealtimeContext").Provider,{value:c,children:n}),t[5]=c,t[6]=n,t[7]=f):f=t[7],f}l.default=c}),98);