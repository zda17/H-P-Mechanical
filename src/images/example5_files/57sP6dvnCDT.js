;/*FB_PKG_DELIM*/

__d("CPXComposerConstants",[],(function(t,n,r,o,a,i){"use strict";var e=120,l=68,s=90,u=160,c=10,d=4;i.THUMBNAIL_WIDTH=e,i.THUMBNAIL_HEIGHT=l,i.REEL_THUMBNAIL_WIDTH=s,i.REEL_THUMBNAIL_HEIGHT=u,i.NUM_OF_THUMBNAILS=c,i.MAX_NUM_THUMBNAILS=d}),66);
__d("CanvasToBlobImpl",["BlobFactory"],(function(t,n,r,o,a,i){function e(e,t){for(var r=atob(e.substr(e.indexOf(",")+1)),o=new Uint8Array(r.length),a=0;a<r.length;a++)o[a]=r.charCodeAt(a);return n("BlobFactory").getBlob([o],{type:t})}a.exports={getBlob:e}}),null);
__d("VideoThumbnail_UNTYPED",["invariant","vulture"],(function(t,n,r,o,a,i,l){var e=(function(){"use strict";function e(e){this.$1=e}var t=e.prototype;return t.getURL=function(){return this.$1},t.getData=function(){n("vulture")("a1B5XUEMmGR-xYeKTjqzsKYluSg="),l(0,4844)},e.addTextToCanvasContext=function(t,r,o,a,i,l,s,u,c){n("vulture")("qikNWy_gjGUk0GFVslGmB8bCVwk="),t.fillStyle=u,t.textAlign=c,t.font=l+"px "+s;var e=c==="center"?a+i/2:a,d=1,m=r.split("\n");for(var p of m){var _="",f="",g=p.split(" ");for(var h of g){f+=h;var y=t.measureText(f).width,C=t.measureText(h).width;if(C>i){_.length>0&&(t.fillText(_,e,o+l*d),d++);var b="",v="";for(var S of h){v+=S;var R=t.measureText(v).width;R>i?(t.fillText(b,e,o+l*d),b=S,v=S,d++):b=v}_=b+" ",f=b+" "}else y>i?(t.fillText(_,e,o+l*d),_=h+" ",f=h+" ",d++):(f+=" ",_=f)}t.fillText(_,e,o+l*d),d++}return t},e})();a.exports=e}),null);
__d("dataURLToBlob",["BlobFactory","CanvasToBlobImpl","CanvasToBlobResource","Promise","WebWorker"],(function(t,n,r,o,a,i,l){var e,s=t.URL||t.webkitURL||{};function u(t,a){return!s.createObjectURL||!r("BlobFactory").isSupported?(e||(e=n("Promise"))).reject("Browser doesn't support this feature"):r("WebWorker").isSupported()?new(e||(e=n("Promise")))(function(e,n){var o=new(r("WebWorker"))(r("CanvasToBlobResource")).setMessageHandler(function(t){e(t),o.terminate()}).setErrorHandler(function(e){n(e.message),o.terminate()}).execute().postMessage({dataURL:t,fileType:a})}):(e||(e=n("Promise"))).resolve(o("CanvasToBlobImpl").getBlob(t,a))}l.default=u}),98);
__d("canvasToBlob",["Promise","dataURLToBlob","promiseDone"],(function(t,n,r,o,a,i,l){var e;function s(t,o,a){return new(e||(e=n("Promise")))(function(e,n){if("toBlob"in t)t.toBlob(e,o,a);else{var i=t.toDataURL(o,a);r("promiseDone")(r("dataURLToBlob")(i,o).then(function(t){e(t)},n))}})}l.default=s}),98);
__d("CanvasVideoThumbnail",["EventListener","Promise","VideoThumbnail_UNTYPED","canvasToBlob","promiseDone"],(function(t,n,r,o,a,i,l){var e,s=(function(t){function o(e,n,r,o,a,i,l){var s;return o===void 0&&(o=null),a===void 0&&(a=null),i===void 0&&(i=0),l===void 0&&(l=0),s=t.call(this,null)||this,s.$CanvasVideoThumbnail$p_1=e,s.$CanvasVideoThumbnail$p_2=n,s.$CanvasVideoThumbnail$p_3=r,s.$CanvasVideoThumbnail$p_4=o,s.$CanvasVideoThumbnail$p_5=a,s.$CanvasVideoThumbnail$p_6=i,s.$CanvasVideoThumbnail$p_7=l,s.$CanvasVideoThumbnail$p_8=s.$CanvasVideoThumbnail$p_1.toDataURL("image/jpeg"),s}babelHelpers.inheritsLoose(o,t);var a=o.prototype;return a.getCanvas=function(){return this.$CanvasVideoThumbnail$p_1},a.getTime=function(){return this.$CanvasVideoThumbnail$p_3?this.$CanvasVideoThumbnail$p_3:0},a.getURL=function(){return this.$CanvasVideoThumbnail$p_8||(this.$CanvasVideoThumbnail$p_8=this.$CanvasVideoThumbnail$p_1.toDataURL("image/jpeg")),this.$CanvasVideoThumbnail$p_8},a.getData=function(){var t=this,o=document.createElement("canvas"),a=o.getContext("2d"),i=this.$CanvasVideoThumbnail$p_2;return new(e||(e=n("Promise")))(function(e,n){var l=r("EventListener").listen(i,"seeked",function(){l.remove(),t.$CanvasVideoThumbnail$p_9(o,a),r("promiseDone")(r("canvasToBlob")(o,"image/jpeg").then(e,n))});i.currentTime=t.$CanvasVideoThumbnail$p_3})},a.getDataWithText=function(o,a,i,l,s,u,c,d){var t=this,m=document.createElement("canvas"),p=m.getContext("2d"),_=this.$CanvasVideoThumbnail$p_2;return new(e||(e=n("Promise")))(function(e,n){var f=r("EventListener").listen(_,"seeked",function(){f.remove(),p.fillStyle=c,p.textAlign=d,t.$CanvasVideoThumbnail$p_9(m,p),p=r("VideoThumbnail_UNTYPED").addTextToCanvasContext(p,o,a,i,l,s,u,c,d),r("promiseDone")(r("canvasToBlob")(m,"image/jpeg").then(e,n))});_.currentTime=t.$CanvasVideoThumbnail$p_3})},a.$CanvasVideoThumbnail$p_9=function(t,n){var e=this.$CanvasVideoThumbnail$p_2;this.$CanvasVideoThumbnail$p_4||this.$CanvasVideoThumbnail$p_5?(t.width=this.$CanvasVideoThumbnail$p_4?this.$CanvasVideoThumbnail$p_4:e.videoWidth,t.height=this.$CanvasVideoThumbnail$p_5?this.$CanvasVideoThumbnail$p_5:e.videoHeight,this.$CanvasVideoThumbnail$p_10(t,n)):(t.width=e.videoWidth,t.height=e.videoHeight,n.drawImage(e,0,0,t.width,t.height))},a.$CanvasVideoThumbnail$p_10=function(t,n){var e=this.$CanvasVideoThumbnail$p_2,r=this.$CanvasVideoThumbnail$p_6,o=this.$CanvasVideoThumbnail$p_7,a=this.$CanvasVideoThumbnail$p_4?this.$CanvasVideoThumbnail$p_4:t.width,i=this.$CanvasVideoThumbnail$p_5?this.$CanvasVideoThumbnail$p_5:t.height;n.drawImage(e,r,o,a,i,0,0,t.width,t.height)},o})(r("VideoThumbnail_UNTYPED"));l.default=s}),98);
__d("HTMLMediaElementReadyStates",[],(function(t,n,r,o,a,i){var e={HAVE_NOTHING:0,HAVE_METADATA:1,HAVE_CURRENT_DATA:2,HAVE_FUTURE_DATA:3,HAVE_ENOUGH_DATA:4},l=e;i.default=l}),66);
__d("LSAppendDataTraceAddon.nop",["LSAppendDataTraceAddonStoredProcedure","LSFactory","MetaConfig","Promise"],(function(t,n,r,o,a,i,l){"use strict";var e,s=function(o,a,i,l,s,u,c){return r("MetaConfig")._("62")?r("LSAppendDataTraceAddonStoredProcedure")(r("LSFactory")(o),{checkPointId:l,dataTraceId:i,errorMessage:u!=null?u:"",syncChannel:s,tags:c!=null?c:""}):(e||(e=n("Promise"))).resolve()};s.__nop_name__="LSAppendDataTraceAddonNop",l.default=s}),98);
__d("LSFeatureLimitsType",[],(function(t,n,r,o,a,i){var e=Object.freeze({READ_ONLY:1,GENERIC_READ_ONLY_BLOCK:2,MESSAGE_SEND:4,MESSENGER_ONLY_ACCOUNTS_READ_ONLY_BLOCK:8,MESSAGE_SEND_PRIVATE:16,MESSAGE_SEND_PUBLIC:32,MESSAGE_SEND_FROM_PAGE:64,COMMERCE_MESSAGE_SEND:128,PAGE_MESSAGING:256,APPEALABLE_MESSAGE_SEND:512,SCREEN_CAPTURE_VIDEO_CALL:1024,MESSENGER_APPEALABLE_MESSAGE_SEND:2048});i.default=e}),66);
__d("LSInsertOptimisticAttachment",["LSSetMessageDisplayedContentTypes"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(r){return t.sequence([function(n){return t.forEach(t.filter(t.db.table(16).fetch([[[e[0],e[2],e[4]]]]),function(n){return t.i64.eq(n.threadKey,e[0])&&t.i64.eq(t.i64.cast([0,0]),t.i64.cast([0,0]))&&n.messageId===e[2]&&n.attachmentFbid===e[4]&&t.i64.lt(n.authorityLevel,t.i64.cast([0,20]))}),function(e){return e.delete()})},function(n){return t.db.table(16).add({threadKey:e[0],messageId:e[2],attachmentFbid:e[4],timestampMs:e[1],offlineAttachmentId:e[3],attachmentType:e[5],attachmentIndex:e[7],filename:e[6],attributionAppId:e[8],hasMedia:e[9],isSharable:!1,hasXma:e[10],authorityLevel:t.i64.cast([0,20])})},function(r){return t.storedProcedure(n("LSSetMessageDisplayedContentTypes"),e[0],e[2],e[1],void 0,!1,t.i64.eq(e[5],t.i64.cast([0,1]))||t.i64.eq(e[5],t.i64.cast([0,15])))}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSMailboxInsertOptimisticAttachmentStoredProcedure",e.__tables__=["attachments"],a.exports=e}),null);
__d("LSIssueNewTaskWithExtraOperationsAndGetTaskID",["LSIssueNewTaskAndGetTaskID","LSMailboxTaskCompletionApiOnTaskInsertion"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(a){return t.sequence([function(o){return t.storedProcedure(n("LSIssueNewTaskAndGetTaskID"),e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[11]).then(function(e){var t;return t=e,r[0]=t[0],t})},function(e){return t.storedProcedure(n("LSMailboxTaskCompletionApiOnTaskInsertion"),r[0])},function(e){return o[0]=r[0]}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSCoreIssueNewTaskWithExtraOperationsAndGetTaskIDStoredProcedure",e.__tables__=[],a.exports=e}),null);
__d("LSMessagingInitiatingSource",[],(function(t,n,r,o,a,i){var e=Object.freeze({FACEBOOK_CHAT:0,FACEBOOK_INBOX:1,ROOMS_SIDE_CHAT:2,FACEBOOK_FULLSCREEN:3,NONE:4,CREATOR_MESSAGING_BIIM:5,CREATOR_MESSAGING_FBM:6,CREATOR_MESSAGING_MBS_WEB:7});i.default=e}),66);
__d("LSPredefineTraceForTask",[],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],n=[],r=[];return t.sequence([function(r){return t.sequence([function(r){return n[0]=t.i64.of_float(Date.now()),t.forEach(t.db.table(2).fetch([[[e[1]]]]),function(t){var r=t.update,o=t.item;return r({dataTraceId:e[0],initTraceTimestampMs:n[0]})})},function(r){return t.db.table(153).add({traceId:e[0],initTimestampMs:n[0],foregroundTimestampMs:t.i64.cast([0,0]),traceType:t.i64.cast([0,1]),shouldFlush:!1,contextOne:e[2],contextTwo:t.i64.to_string(e[1]),predefinedId:e[3]})}])},function(e){return t.resolve(r)}])}e.__sproc_name__="LSDataTracePredefineTraceForTaskStoredProcedure",e.__tables__=["pending_tasks","data_trace_meta"],a.exports=e}),null);
__d("MAWDocumentPreProcess",["WABlobToArrayBuffer","WATagsLogger"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=o("WATagsLogger").TAGS(["MAWDocumentPreProcess"]);async function c(t){return u.DEV(e||(e=babelHelpers.taggedTemplateLiteralLoose(["start document preprocess"]))),Promise.resolve({file:t,filename:t.name,plaintext:await o("WABlobToArrayBuffer").blobToArrayBuffer(t),type:"document"})}function d(e){u.DEV(s||(s=babelHelpers.taggedTemplateLiteralLoose(["start optimistic document preprocess"])));var n=t.URL.createObjectURL(e);return Promise.resolve({file:e,filename:e.name,type:"document",url:n})}l.documentPreprocess=c,l.optimisticDocumentPreprocess=d}),98);
__d("isReceiverFetchSticker",["I64","LSIntEnum","MessagingAttachmentType"],(function(t,n,r,o,a,i,l){"use strict";var e,s;function u(t){var n=t.attachmentType,a=(e||(e=o("I64"))).equal(n,(s||(s=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").STICKER)),i=t.receiverFetchId;return a&&i!=null}l.default=u}),98);
__d("MAWMediaDownloadStatusBackendFetcher",["I64","LSAuthorityLevel","LSIntEnum","MAWBridgeSendAndReceive","MAWDbMedia","MAWMediaSetClientMediaStatus","MessagingAttachmentType","ODS","WAHashUtils","isReceiverFetchSticker","promiseDone","react","react-compiler-runtime","useAsyncReStore"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d=(e||(e=o("react"))).useEffect,m=new Set;function p(e){var t=o("react-compiler-runtime").c(7),n=e.attachment,a=e.mediaRenderQpl,i=e.mediaStatus,l=e.statusKey,s=r("useAsyncReStore")(),u,c;t[0]!==n||t[1]!==s||t[2]!==a||t[3]!==i||t[4]!==l?(u=function(){f(n,a,i,l,s)},c=[s,n,a,i,l],t[0]=n,t[1]=s,t[2]=a,t[3]=i,t[4]=l,t[5]=u,t[6]=c):(u=t[5],c=t[6]),d(u,c)}function _(e){var t=o("react-compiler-runtime").c(4),n=r("useAsyncReStore")(),a,i;t[0]!==e||t[1]!==n?(a=function(){e.forEach(function(e){var t=e.attachment,r=e.mediaRenderQpl,o=e.mediaStatus,a=e.statusKey;f(t,r,o,a,n,!0)})},i=[n,e],t[0]=e,t[1]=n,t[2]=a,t[3]=i):(a=t[2],i=t[3]),d(a,i)}function f(e,t,n,a,i,l){if(l===void 0&&(l=!1),!(e==null||a==null)){var d=r("isReceiverFetchSticker")(e),p=(s||(s=o("I64"))).equal(e.attachmentType,(u||(u=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").XMA)),_=e.transportKey==="FBBroker"||e.transportKey==="FBLegacyBroker",f=!_&&(s||(s=o("I64"))).to_int32(e.authorityLevel)===r("LSAuthorityLevel").OPTIMISTIC,g=n!=null,h=p||f||_||d||g||m.has(a);if(h){(c||(c=o("ODS"))).bumpEntityKey(3185,"media_initial_download_status",(l?"bulk":"single")+".skip"),t==null||t.addPoint("skip_fetch_download_status");return}var y=isNaN(a);(c||(c=o("ODS"))).bumpEntityKey(3185,"media_initial_download_status",(l?"bulk":"single")+".request."+(y?"plaintext":"media_id")),t==null||t.addPoint("request_download_status"),m.add(a);var C=y?o("MAWBridgeSendAndReceive").sendAndReceive("backend","getMediaDownloadStatusByPlaintextHash",{plaintextHash:o("WAHashUtils").stringToPlaintextHash(a),qplInstanceKey:t==null?void 0:t.getInstanceKey()}):o("MAWBridgeSendAndReceive").sendAndReceive("backend","getMediaDownloadStatusByMediaId",{mediaId:o("MAWDbMedia").convertNumberToMediaId(parseInt(a,10)),qplInstanceKey:t==null?void 0:t.getInstanceKey()});r("promiseDone")(C.then(function(e){e!=null&&o("MAWMediaSetClientMediaStatus").call(i,a,e)}))}}l.useFetchInitialDownloadStatus=p,l.useFetchInitialDownloadStatusBulk=_}),98);
__d("MAWMediaDownloadStatusUIState",["I64","LSAuthorityLevel","LSIntEnum","LSMediaUrlUtils","MAWClientMediaStatusUtils","MAWMediaDownloadStatus","MessagingAttachmentType","WATagsLogger"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c=o("WATagsLogger").TAGS(["MediaDownload"]),d=5;function m(t,n,a){if((a==null?void 0:a.receiverFetchId)!=null&&o("LSMediaUrlUtils").hasValidReceiverFetchPreviewUrl(a.previewUrl,a.previewUrlExpirationTimestampMs))return"downloaded";var i=n>=d,l=t!=null?t:{},s=l.mainMediaStatus,u=l.previewMediaStatus,m=t==null||s===r("MAWMediaDownloadStatus").DOWNLOADING||s===r("MAWMediaDownloadStatus").MISSING_FILE||s===r("MAWMediaDownloadStatus").RETRYING||s===r("MAWMediaDownloadStatus").AUTOMATICALLY_RETRYABLE_TIMEOUT_FAILURE,p=s===r("MAWMediaDownloadStatus").SUCCESS,f=s===r("MAWMediaDownloadStatus").MANUAL_RETRYABLE_FAILURE,g=f&&i,h=s===r("MAWMediaDownloadStatus").NOT_MANUAL_RETRYABLE_FAILURE,y=t==null||u===r("MAWMediaDownloadStatus").RETRYING||u===r("MAWMediaDownloadStatus").DOWNLOADING||u===r("MAWMediaDownloadStatus").MISSING_FILE||u===void 0&&m,C=u===r("MAWMediaDownloadStatus").SUCCESS,b=u===r("MAWMediaDownloadStatus").MANUAL_RETRYABLE_FAILURE||u===void 0&&f,v=b&&i,S=u===r("MAWMediaDownloadStatus").NOT_MANUAL_RETRYABLE_FAILURE||u===void 0&&h,R=a!=null&&_(a);if(R&&!y){if(C||p)return h||g?"non_retryable_error_with_preview":f?"retryable_error_with_preview":"downloaded";if(S||v)return"non_retryable_error";if(b)return"retryable_error"}else{if(p)return"downloaded";if(h||g)return"non_retryable_error";if(f)return"retryable_error";if(m)return"loading"}return c.WARN(e||(e=babelHelpers.taggedTemplateLiteralLoose(["useMAWMediaDownloadStatusUIState: unexpected download status"]))),"loading"}function p(e,t,n){var a,i=(n==null?void 0:n.transportKey)==="FBBroker"||(n==null?void 0:n.transportKey)==="FBLegacyBroker",l=!i&&n!=null&&(s||(s=o("I64"))).to_int32(n.authorityLevel)===r("LSAuthorityLevel").OPTIMISTIC,c=l&&t!=null?{id:t,mainMediaStatus:(u||(u=o("LSIntEnum"))).ofNumber(1),mainMediaStatusDetails:"optimistic_secure_upload",previewMediaStatus:(u||(u=o("LSIntEnum"))).ofNumber(1),previewMediaStatusDetails:"optimistic_secure_upload"}:e,d=c!=null?o("MAWClientMediaStatusUtils").getMAWMediaStatus(c):null,p=m(d,(s||(s=o("I64"))).to_int32((a=c==null?void 0:c.downloadRetryCount)!=null?a:(s||(s=o("I64"))).zero),n);return{mawMediaStatus:d,nonDebouncedUIState:p,status:c}}function _(e){if(e==null)return!1;var t=e.attachmentType;return(s||(s=o("I64"))).equal(t,(u||(u=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").IMAGE))||(s||(s=o("I64"))).equal(t,(u||(u=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").VIDEO))}l.getMediaDownloadStatusUIState=m,l.getNonDebouncedUIStateAndStatus=p}),98);
__d("VideoFrameBuffer",["HTMLMediaElementReadyStates","getErrorSafe"],(function(t,n,r,o,a,i,l){var e=(function(){function e(e,t,n,r,o,a,i){r===void 0&&(r=null),o===void 0&&(o=null),a===void 0&&(a=null),i===void 0&&(i=null),this.$2=t,this.$1=e,this.$3=n||"contain",this.$6=r,this.$7=o,this.$8=a,this.$9=i}var t=e.prototype;return t.updateFrameBuffer=function(){if(this.$4&&(this.$1.width=this.$4,this.$4=null),this.$5&&(this.$1.height=this.$5,this.$5=null),!(this.$2.readyState<r("HTMLMediaElementReadyStates").HAVE_CURRENT_DATA)){var e=this.$1.clientWidth||this.$1.width,t=this.$1.clientHeight||this.$1.height,n=e,o=t,a=this.$2.videoWidth/this.$2.videoHeight,i=n/o;this.$3==="cover"&&(i*=-1,a*=-1),i>a?n=o*a:i<a&&(o=n/a);var l=this.$1.getContext("2d");if(l instanceof window.CanvasRenderingContext2D)try{if(this.$6||this.$7){var s,u,c,d;l.drawImage(this.$2,(s=this.$8)!=null?s:0,(u=this.$9)!=null?u:0,(c=this.$6)!=null?c:e,(d=this.$7)!=null?d:t,0,0,e,t)}else l.drawImage(this.$2,(e-n)/2,(t-o)/2,n,o)}catch(e){var m=r("getErrorSafe")(e);if(m.name!=="NS_ERROR_NOT_AVAILABLE")throw m}}},t.getDOMNode=function(){return this.$1},t.updateDimensions=function(t,n){this.$4=t,this.$5=n},e})();l.default=e}),98);
__d("generateVideoThumbnails",["CPXComposerConstants","CanvasVideoThumbnail","HTMLMediaElementReadyStates","Promise","VideoFrameBuffer","cr:909281"],(function(t,n,r,o,a,i,l){var e,s=.5625;function u(t,o,a,i,l,s,u,f,g,h){return l===void 0&&(l="contain"),s===void 0&&(s=0),u===void 0&&(u=null),f===void 0&&(f=null),g===void 0&&(g=null),h===void 0&&(h=null),new(e||(e=n("Promise")))(function(e,y){var C=document.createElement("canvas"),b=[],v=0,S=t.duration-s;h!=null&&(S=Math.min(S,h));var R=S/i,L=null,E=null,k,I=f!=null?f:c(u,o),T=g!=null?g:d(u,a),D=m(u,o),x=p(u,a);C.width=I!=null?I:o,C.height=T!=null?T:a;var $=new(r("VideoFrameBuffer"))(C,t,l,I,T,D,x);$.updateFrameBuffer();var P=function(){$.updateFrameBuffer();var e=new(r("CanvasVideoThumbnail"))(C,t,s+(v-1)*R,I,T,D,x);b.push(e),(!L||e.getURL().length>L.getURL().length)&&(L=e,E=_(u,t)),M()},N=function(){if(t.readyState>=r("HTMLMediaElementReadyStates").HAVE_CURRENT_DATA)P();else if(n("cr:909281")!==null)var e=n("cr:909281").listen(t,"loadeddata",function(){e.remove(),P()});else t.addEventListener("loadeddata",P,{once:!0})},M=function(){v===0&&(n("cr:909281")!==null?k=n("cr:909281").listen(t,"seeked",N):t.addEventListener("seeked",N)),v<i?(t.currentTime=s+v*R,v++):(n("cr:909281")!==null?k&&k.remove():t.removeEventListener("seeked",N),e({thumbnails:b,selectedThumbnail:L,croppedThumbnailUri:E}))};if(t.videoWidth===0||t.videoHeight===0){y();return}M()})}function c(e,t){if(e&&e.spherical){if(e.stereoMode==="left-right")return t/2;if(e.projectionType==="cubemap")return t/3}return null}function d(e,t){return e&&e.spherical&&(e.stereoMode==="top-bottom"||e.projectionType==="cubemap")?t/2:null}function m(e,t){return e&&e.spherical&&e.projectionType==="cubemap"?t/3:0}function p(e,t){return e&&e.spherical&&e.projectionType==="cubemap"?t/2:0}function _(e,t){var n=t.videoWidth!=null&&t.videoHeight!=null?t.videoWidth/t.videoHeight:s,r=n<1;if(e==null&&!r){var a=document.createElement("canvas"),i=a.getContext("2d"),l=t.videoWidth,u=t.videoHeight;a.width=l,a.height=u,i.drawImage(t,0,0,l,u);var c=document.createElement("canvas"),d,m;n>=1&&n<1.2?(d=l*(o("CPXComposerConstants").REEL_THUMBNAIL_WIDTH/o("CPXComposerConstants").REEL_THUMBNAIL_HEIGHT),m=u):(d=u,m=l),c.width=d,c.height=m;var p=c.getContext("2d");return p.drawImage(a,0,0,l,u,0,0,d,m),c.toDataURL("image/jpeg")}return null}l.default=u}),98);
__d("MAWVideoUtils",["FBLogger","MAWImageUtils","Promise","generateVideoThumbnails"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(t){var a=document.body;if(!a)return new(e||(e=n("Promise")))(function(e,t){return t("Unable to find DOM body, please use this util only in DOM environment.")});var i=document.createElement("video");return new(e||(e=n("Promise")))(function(o,l){i.setAttribute("style","display: none"),i.setAttribute("src",URL.createObjectURL(t)),i.addEventListener("loadedmetadata",function(t){var a=t.currentTarget;if(a instanceof HTMLVideoElement){var s=a.duration,u=a.videoHeight,c=a.videoWidth,d=r("generateVideoThumbnails")(i,c,u,1);o((e||(e=n("Promise"))).all([d,c,u,Math.round(s)]))}else l("EventTarget returned for event should be HTMLVideoElement")}),i.addEventListener("error",function(e){l("Unable to load video")}),a.appendChild(i)}).then(function(e){var t=e[0],n=e[1],r=e[2],l=e[3];return a.removeChild(i),o("MAWImageUtils").canvasToBlob(t.thumbnails[0].getCanvas(),o("MAWImageUtils").TYPE_JPEG,!0).then(function(e){return e.arrayBuffer().then(function(e){return{duration:l,height:r,jpegThumbnail:e,width:n}})})}).catch(function(e){throw a.removeChild(i),r("FBLogger")("messenger_web").mustfixThrow(e)})}function u(t){var o=document.body;if(!o)return new(e||(e=n("Promise")))(function(e,t){return t("Unable to find DOM body, please use this util only in DOM environment.")});var a=document.createElement("video");return new(e||(e=n("Promise")))(function(e,n){a.setAttribute("style","display: none"),a.setAttribute("src",URL.createObjectURL(t)),a.addEventListener("loadedmetadata",function(t){var r=t.currentTarget;if(r instanceof HTMLVideoElement){var o=r.duration,a=r.videoHeight,i=r.videoWidth;e({duration:Math.round(o),height:a,width:i})}else n("EventTarget returned for event should be HTMLVideoElement")}),a.addEventListener("error",function(e){n("Unable to load video")}),o.appendChild(a)}).catch(function(e){throw o.removeChild(a),r("FBLogger")("messenger_web").mustfixThrow(e)})}l.getVideoThumbnailUrlAndSpec=s,l.getVideoThumbnailSpec=u}),98);
__d("MWChatForwardDialogQuery_facebookRelayOperation",[],(function(t,n,r,o,a,i){a.exports="25105114172492238"}),null);
__d("MWPFeatureLimitedData",["I64","Int64Hooks","LSFeatureLimitsType","LSIntEnum","LSMessagingThreadTypeUtil","ReQL","ReQLSuspense","ServerTime","gkx","react-compiler-runtime","useReStore","useServerTime"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c=[(s||(s=o("LSIntEnum"))).ofNumber(r("LSFeatureLimitsType").READ_ONLY),s.ofNumber(r("LSFeatureLimitsType").GENERIC_READ_ONLY_BLOCK),s.ofNumber(r("LSFeatureLimitsType").MESSAGE_SEND)];function d(e){for(var t of c)if((u||(u=o("I64"))).equal(t,e.type_))return!0;return!1}function m(e,t){return(u||(u=o("I64"))).equal((s||(s=o("LSIntEnum"))).ofNumber(r("LSFeatureLimitsType").MESSAGE_SEND_PUBLIC),e.type_)&&o("LSMessagingThreadTypeUtil").isPublicCMThread(t)&&r("gkx")("26351")}function p(e,t){return(u||(u=o("I64"))).equal((s||(s=o("LSIntEnum"))).ofNumber(r("LSFeatureLimitsType").MESSAGE_SEND_PRIVATE),e.type_)&&o("LSMessagingThreadTypeUtil").isPrivateThread(t)}var _=function(t){var e=(u||(u=o("I64"))).of_float(o("ServerTime").getMillis()/1e3);return o("ReQL").fromTableAscending(t.tables.feature_limits).filter(function(t){return d(t)&&(u||(u=o("I64"))).gt(t.expirationTimestampSeconds,e)})};function f(e,t){var n=o("react-compiler-runtime").c(8),a=(u||(u=o("I64"))).of_float(r("useServerTime")().valueOf()/1e3),i;n[0]!==a||n[1]!==e.tables.feature_limits||n[2]!==t?(i=function(){return o("ReQL").fromTableAscending(e.tables.feature_limits).filter(function(e){return(t!=null?d(e)||m(e,t)||p(e,t):d(e))&&(u||(u=o("I64"))).gt(e.expirationTimestampSeconds,a)})},n[0]=a,n[1]=e.tables.feature_limits,n[2]=t,n[3]=i):i=n[3];var l;return n[4]!==a||n[5]!==e||n[6]!==t?(l=[a,e,t],n[4]=a,n[5]=e,n[6]=t,n[7]=l):l=n[7],o("Int64Hooks").useMemoInt64(i,l)}function g(){var t=o("react-compiler-runtime").c(3),n=(e||(e=r("useReStore")))(),a,l;return t[0]!==n?(a=function(){return _(n)},l=[n],t[0]=n,t[1]=a,t[2]=l):(a=t[1],l=t[2]),o("ReQLSuspense").useFirst(a,l,i.id+":127")}function h(t){var n=o("react-compiler-runtime").c(3),a=(e||(e=r("useReStore")))(),l=f(a,t),s,u;return n[0]!==l?(s=function(){return l},u=[l],n[0]=l,n[1]=s,n[2]=u):(s=n[1],u=n[2]),o("ReQLSuspense").useFirst(s,u,i.id+":136")}l.readonlyFeatureLimitQuery=_,l.useReadOnlyFeatureLimitData=g,l.useReadOnlyFeatureLimitDataWithThreadType=h}),98);
__d("MWPThreadCapabilitiesContext",["I64","Int64Hooks","LSIntEnum","LSMessageThreadUnsendabilityStatus","LSThreadBitOffset","ThreadStatus","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c=e||(e=o("react")),d=e,m=d.createContext,p=d.useContext,_=m({air131ShareChatMessagesWithMetaAiEnabled:!1,blurMediaEnabled:!1,canUnsendMessage:!1,communityMessagingChannelDescriptionCustomization:!1,communityMessagingChannelInvite:!1,disableLinks:!1,editMessageEnabled:!1,feedbackAndReportEnabled:!1,hasLSThreadBitOffset:function(t){return!1},isPaused:!1,localDeleteMessageEnabled:!1,messageForwardEnabled:!1,messageUnsendEnabled:!1,modifyPinnedMessageV2Enabled:!1,reactEnabled:!1,reactionsV2WriteEnabled:!1,replyEnabled:!1,reportMessageToAdminEnabled:!1,rtcVideoCallEnabled:!1,rtcVoiceCallEnabled:!1,seenCountV2Enabled:!1,subThreadCreationEnabled:!1});function f(e){var t=o("react-compiler-runtime").c(17),n=e.children,a=e.customCapabilityCheck,i=e.thread,l=i.capabilities,d=i.capabilities2,m=i.capabilities3,p=i.capabilities4,f=i.capabilities5,g=i.threadType,h,y;t[0]!==l||t[1]!==d||t[2]!==m||t[3]!==p||t[4]!==f||t[5]!==g?(h=function(t){var e={capabilities:l,capabilities2:d,capabilities3:m,capabilities4:p,capabilities5:f,threadType:g};return o("LSThreadBitOffset").has(t,e)},y=[l,d,m,p,f,g],t[0]=l,t[1]=d,t[2]=m,t[3]=p,t[4]=f,t[5]=g,t[6]=h,t[7]=y):(h=t[6],y=t[7]);var C=o("Int64Hooks").useCallbackInt64(h,y),b,v;t[8]!==a||t[9]!==C||t[10]!==i.cannotUnsendReason||t[11]!==i.threadStatus?(b=function(){return{air131ShareChatMessagesWithMetaAiEnabled:C(256),blurMediaEnabled:C(46),canUnsendMessage:i.cannotUnsendReason!=null?(s||(s=o("I64"))).equal(i.cannotUnsendReason,(u||(u=o("LSIntEnum"))).ofNumber(r("LSMessageThreadUnsendabilityStatus").CAN_UNSEND)):!0,communityMessagingChannelDescriptionCustomization:C(135),communityMessagingChannelInvite:C(120),disableLinks:C(45),editMessageEnabled:C(194),feedbackAndReportEnabled:C(17),hasLSThreadBitOffset:C!=null?C:a,isPaused:i.threadStatus!=null&&((s||(s=o("I64"))).equal(i.threadStatus,(s||(s=o("I64"))).of_int32(r("ThreadStatus").PAUSED))||(s||(s=o("I64"))).equal(i.threadStatus,(s||(s=o("I64"))).of_int32(r("ThreadStatus").PAUSED_AND_UPGRADED_TO_COMMUNITY))),localDeleteMessageEnabled:C(102),messageForwardEnabled:C(103),messageUnsendEnabled:C(122)&&i.cannotUnsendReason!=null?(s||(s=o("I64"))).equal(i.cannotUnsendReason,(u||(u=o("LSIntEnum"))).ofNumber(r("LSMessageThreadUnsendabilityStatus").CAN_UNSEND)):!1,modifyPinnedMessageV2Enabled:C(172),reactEnabled:C(18),reactionsV2WriteEnabled:C(169),replyEnabled:C(42),reportMessageToAdminEnabled:C(93),rtcVideoCallEnabled:C(24),rtcVoiceCallEnabled:C(25),seenCountV2Enabled:C(140),subThreadCreationEnabled:C(167)}},v=[a,C,i.threadStatus,i.cannotUnsendReason],t[8]=a,t[9]=C,t[10]=i.cannotUnsendReason,t[11]=i.threadStatus,t[12]=b,t[13]=v):(b=t[12],v=t[13]);var S=o("Int64Hooks").useMemoInt64(b,v),R;return t[14]!==n||t[15]!==S?(R=c.jsx(_.Provider,{value:S,children:n}),t[14]=n,t[15]=S,t[16]=R):R=t[16],R}function g(){return p(_)}l.Provider=f,l.useMWPThreadCapabilitiesContext=g}),98);
__d("MWUnvaultedText",["cr:2472","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l){"use strict";var e,s=(e||(e=o("react"))).useMemo,u=function(t,r){return n("cr:2472")==null||r==null||r===""?r:t?n("cr:2472").unvaultOrThrow(r):n("cr:2472").unvault(r,!0)};function c(e,t){var n=o("react-compiler-runtime").c(3),r;n[0]!==e||n[1]!==t?(r=u(e,t),n[0]=e,n[1]=t,n[2]=r):r=n[2];var a=r;return a}l.getMWUnvaultedText=u,l.useMWUnvaultedText=c}),98);
__d("MWV2LogMessageClick",["I64","LSMessagingThreadTypeUtil","Promise","ReQL","UserAgentData","promiseDone","requireDeferred"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=r("requireDeferred")("LsMessageClickFalcoEvent").__setRef("MWV2LogMessageClick");function c(t,a,i,l){var c=a.threadKey;r("promiseDone")(o("ReQL").firstAsync(o("ReQL").fromTableAscending(t.tables.threads).getKeyRange(c)).then(function(t){return t!=null&&!o("LSMessagingThreadTypeUtil").isArmadilloSecure(t.threadType)&&u.onReady(function(e){e.log(function(){return{click:{category:2},click_target:{type:i},extra:JSON.stringify({action:l!=null?l:void 0,browserName:r("UserAgentData").browserName}),message:{id:a.messageId,sender_id:void 0,sent_time:(s||(s=o("I64"))).to_float(a.timestampMs)},thread:{id:s.to_string(a.threadKey),key:void 0,type:void 0},xma:void 0}})}),(e||(e=n("Promise"))).resolve()}))}l.log=c}),98);
__d("MWV2MessageRowIsRowFocusedContext.react",["emptyFunction","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react")),u=e,c=u.createContext,d=u.useContext,m={isDialogOpened:!1,setFocused:r("emptyFunction"),setIsDialogOpened:r("emptyFunction")},p=c(m);function _(){return d(p)}function f(e){var t=o("react-compiler-runtime").c(3),n=e.children,r=e.value,a=p.Provider,i;return t[0]!==n||t[1]!==r?(i=s.jsx(a,{value:r,children:n}),t[0]=n,t[1]=r,t[2]=i):i=t[2],i}l.context=p,l.useMWV2MessageRowIsRowFocusedContext=_,l.MWV2MessageRowIsRowFocusedContextProvider=f}),98);
__d("genArrayBufferFromFile",["Promise"],(function(t,n,r,o,a,i){"use strict";var e;function l(t){return"arrayBuffer"in t?t.arrayBuffer():new(e||(e=n("Promise")))(function(e,n){var r=new FileReader;r.onload=function(){var t=r.result;t instanceof ArrayBuffer?e(t):n()},r.onerror=function(){n(r.error)},r.readAsArrayBuffer(t)})}i.default=l}),66);
__d("genIsNonAnimatedWebPFile",["genArrayBufferFromFile"],(function(t,n,r,o,a,i,l){"use strict";var e=8;function s(e){return r("genArrayBufferFromFile")(e).then(function(e){var t=new Uint8Array(e),n=t.slice(12,16).reduce(function(e,t,n){return e+String.fromCharCode(t)},"");if(n==="VP8X"){var r=t[20],o=r.toString(2).padStart(8,"0");if(o[6]==="1")return!u(t)}return!0})}function u(t){for(var n=12,r=0;r<2&&n+e<t.length;){var o=c(t,n);o==="ANMF"&&r++;var a=d(t,n+4),i=a%2,l=e+a+i;n+=l}return r>1}function c(e,t){return e.slice(t,t+4).reduce(function(e,t,n){return e+String.fromCharCode(t)},"")}function d(e,t){return parseInt(e.slice(t,t+4).reduce(function(e,t,n){return t.toString(2).padStart(8,"0")+e},""),2)}l.default=s}),98);
__d("getFBTSafeGenderFromGenderConst",["GenderConst","IntlVariations"],(function(t,n,r,o,a,i,l){"use strict";function e(e){switch(e){case r("GenderConst").MALE_SINGULAR:return r("IntlVariations").GENDER_MALE;case r("GenderConst").FEMALE_SINGULAR:return r("IntlVariations").GENDER_FEMALE;default:return r("IntlVariations").GENDER_UNKNOWN}}l.default=e}),98);
__d("getMessengerTimeBucket",["$InternalEnum"],(function(t,n,r,o,a,i){"use strict";var e=n("$InternalEnum").Mirrored(["TODAY","WEEK_AGO","CURRENT_YEAR","OTHER_YEAR"]),l=864e5,s=6*l;function u(t){var n=new Date(t),r=new Date,o=new Date(r.getFullYear(),r.getMonth(),r.getDate());return o<n?e.TODAY:o.getTime()-s<n.getTime()?e.WEEK_AGO:o.getFullYear()===n.getFullYear()?e.CURRENT_YEAR:e.OTHER_YEAR}function c(t){return u(t)===e.TODAY}i.MessengerTimeBucket=e,i.getMessengerTimeBucket=u,i.isTimeOnlyTimestamp=c}),66);
__d("getMessengerPreciseTimestamp",["formatDate","getMessengerTimeBucket"],(function(t,n,r,o,a,i,l){"use strict";var e=Object.freeze({CURRENT_YEAR:"F jS, g:ia",OTHER_YEAR:"F j, Y g:i a",TODAY:"g:ia",WEEK_AGO:"l g:ia"});function s(t){var n=o("getMessengerTimeBucket").getMessengerTimeBucket(t);switch(n){case o("getMessengerTimeBucket").MessengerTimeBucket.TODAY:return e.TODAY;case o("getMessengerTimeBucket").MessengerTimeBucket.WEEK_AGO:return e.WEEK_AGO;case o("getMessengerTimeBucket").MessengerTimeBucket.CURRENT_YEAR:return e.CURRENT_YEAR;case o("getMessengerTimeBucket").MessengerTimeBucket.OTHER_YEAR:return e.OTHER_YEAR}}function u(e,t){return r("formatDate")(new Date(e),s(e),void 0,t)}l.default=u}),98);
__d("isFeatureLimitEnabled",["qex"],(function(t,n,r,o,a,i,l){"use strict";function e(){return r("qex")._("588")===!0}l.default=e}),98);
__d("useIsReadOnlyFeatureLimitedWithThreadType",["MWPFeatureLimitedData"],(function(t,n,r,o,a,i,l){"use strict";function e(e){var t=o("MWPFeatureLimitedData").useReadOnlyFeatureLimitDataWithThreadType(e);return t!=null}l.default=e}),98);
__d("useIsSecureMessage",["LSMessagingThreadTypeUtil","ReQL","ReQLSuspense","react-compiler-runtime"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t,n){var r,a=o("react-compiler-runtime").c(2),l=(r=o("ReQLSuspense").useFirst(function(){return t==null?o("ReQL").empty():o("ReQL").fromTableAscending(e.tables.threads,["threadType"]).getKeyRange(t.threadKey).map(s)},[e,t],i.id+":37"))!=null?r:n.fallbackThreadType;if(l==null){var u;return(u=n.fallbackIsSecure)!=null?u:!1}var c;return a[0]!==l?(c=o("LSMessagingThreadTypeUtil").isArmadilloSecure(l),a[0]=l,a[1]=c):c=a[1],c}function s(e){var t=e.threadType;return t}l.default=e}),98);
__d("useLSMessagingInitiatingSource",["LSIntEnum","LSMessagingInitiatingSource","MWLSThreadDisplayContext","react-compiler-runtime"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(){var t=o("react-compiler-runtime").c(4),n=o("MWLSThreadDisplayContext").useMWLSThreadDisplayContext();if(n!=null)if(n==="Inbox"){var a;return t[0]===Symbol.for("react.memo_cache_sentinel")?(a=(e||(e=o("LSIntEnum"))).ofNumber(r("LSMessagingInitiatingSource").FACEBOOK_INBOX),t[0]=a):a=t[0],a}else if(n==="FullscreenChat"){var i;return t[1]===Symbol.for("react.memo_cache_sentinel")?(i=(e||(e=o("LSIntEnum"))).ofNumber(r("LSMessagingInitiatingSource").FACEBOOK_FULLSCREEN),t[1]=i):i=t[1],i}else if(n==="ChatTab"){var l;return t[2]===Symbol.for("react.memo_cache_sentinel")?(l=(e||(e=o("LSIntEnum"))).ofNumber(r("LSMessagingInitiatingSource").FACEBOOK_CHAT),t[2]=l):l=t[2],l}else{var s;return t[3]===Symbol.for("react.memo_cache_sentinel")?(s=(e||(e=o("LSIntEnum"))).ofNumber(r("LSMessagingInitiatingSource").ROOMS_SIDE_CHAT),t[3]=s):s=t[3],s}}l.default=s}),98);
__d("useMAWMediaDebouncedState",["clearTimeout","justknobx","react","react-compiler-runtime","setTimeout"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react")),u=s.useCallback,c=s.useRef,d=s.useState;function m(e){var t=o("react-compiler-runtime").c(5),n;t[0]===Symbol.for("react.memo_cache_sentinel")?(n=r("justknobx")._("3145"),t[0]=n):n=t[0];var a=n,i=d(e),l=i[0],s=i[1],u=c(null),m;t[1]===Symbol.for("react.memo_cache_sentinel")?(m=function(){r("clearTimeout")(u.current),u.current=null},t[1]=m):m=t[1];var p=m,_;t[2]===Symbol.for("react.memo_cache_sentinel")?(_=function(t,n){if(p(),!n){s(t);return}u.current=r("setTimeout")(function(){s(t)},a)},t[2]=_):_=t[2];var f=_,g;return t[3]!==l?(g=[l,f,p],t[3]=l,t[4]=g):g=t[4],g}l.default=m}),98);
__d("useMAWBulkMediaDownloadStatusUIStateDebounced",["react","react-compiler-runtime","useMAWMediaDebouncedState"],(function(t,n,r,o,a,i,l){"use strict";var e,s=(e||(e=o("react"))).useEffect;function u(e){var t=o("react-compiler-runtime").c(4),n=r("useMAWMediaDebouncedState")(e),a=n[0],i=n[1],l,u;return t[0]!==i||t[1]!==e?(l=function(){i(e,!e.some(c))},u=[e,i],t[0]=i,t[1]=e,t[2]=l,t[3]=u):(l=t[2],u=t[3]),s(l,u),a}function c(e){return e==="loading"||e==="downloaded"}l.default=u}),98);
__d("useMAWMediaDownloadStatusBulk",["MAWMediaDownloadStatusBackendFetcher","MAWMediaDownloadStatusUIState","react","react-compiler-runtime","useMAWBulkMediaDownloadStatusUIStateDebounced"],(function(t,n,r,o,a,i,l){"use strict";var e,s=(e||(e=o("react"))).useMemo;function u(e,t){var n=o("react-compiler-runtime").c(10),a;if(n[0]!==e||n[1]!==t){var i;n[3]!==t?(i=function(n){var e=n.attachment,r=n.mediaRenderQpl,a=n.mediaStatus,i=n.statusKey,l=a!=null?a:t==null?void 0:t.find(function(e){var t=e.id;return t===i});return babelHelpers.extends({},o("MAWMediaDownloadStatusUIState").getNonDebouncedUIStateAndStatus(l,i,e),{attachment:e,mediaRenderQpl:r,statusKey:i})},n[3]=t,n[4]=i):i=n[4],a=e.map(i),n[0]=e,n[1]=t,n[2]=a}else a=n[2];var l=a,s;if(n[5]!==l){var u=[],c=[],d=[];l.forEach(function(e){u.push(e.mawMediaStatus),c.push(e.nonDebouncedUIState),d.push({attachment:e.attachment,mediaRenderQpl:e.mediaRenderQpl,mediaStatus:e.status,statusKey:e.statusKey})}),s=[u,c,d],n[5]=l,n[6]=s}else s=n[6];var m=s,p=m[0],_=m[1],f=m[2],g=r("useMAWBulkMediaDownloadStatusUIStateDebounced")(_);o("MAWMediaDownloadStatusBackendFetcher").useFetchInitialDownloadStatusBulk(f);var h;return n[7]!==g||n[8]!==p?(h={mawMediaStatuses:p,uiStates:g},n[7]=g,n[8]=p,n[9]=h):h=n[9],h}l.default=u}),98);