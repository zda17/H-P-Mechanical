;/*FB_PKG_DELIM*/

__d("LSUpdateEventStartAndEndTime",[],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],n=[],r=[];return t.sequence([function(n){return t.forEach(t.db.table(9).fetch([[[e[0]]]]),function(t){var n=t.update,r=t.item;return n({eventStartTimestampMs:e[1],eventEndTimestampMs:e[2]})})},function(e){return t.resolve(r)}])}e.__sproc_name__="LSMailboxUpdateEventStartAndEndTimeStoredProcedure",e.__tables__=["threads"],a.exports=e}),null);
__d("LSClearEventStartAndEndTime",["LSUpdateEventStartAndEndTime"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(o){return t.sequence([function(n){return t.islc(t.db.table(201).fetch([[[e[0]]]]),0,t.i64.to_float(t.i64.cast([0,1]))).next().then(function(e,t){var n=e.done,o=e.value;return n?r[0]=void 0:(t=o.item,r[0]=t.threadId)})},function(e){return t.i64.neq(r[0],void 0)?t.storedProcedure(n("LSUpdateEventStartAndEndTime"),r[0],void 0,void 0):t.resolve()}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSMailboxClearEventStartAndEndTimeStoredProcedure",e.__tables__=["cm_channel_events"],a.exports=e}),null);
__d("LSClearAllCmEventStartAndEndTimes",["LSClearEventStartAndEndTime"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(e){return t.forEach(t.db.table(201).fetch(),function(e){var r=e.item;return t.storedProcedure(n("LSClearEventStartAndEndTime"),r.eventId)})},function(e){return t.resolve(o)}])}e.__sproc_name__="LSMailboxClearAllCmEventStartAndEndTimesStoredProcedure",e.__tables__=["cm_channel_events"],a.exports=e}),null);
__d("LSDeleteAllCmFbEventData",["LSArrayGetObjectAt","LSClearAllCmEventStartAndEndTimes"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(e){return t.sequence([function(e){return t.storedProcedure(n("LSClearAllCmEventStartAndEndTimes"))},function(e){return r[0]=t.createArray(),t.forEach(t.db.table(201).fetch(),function(e){var t=e.item;return r[2]=(r[0].push(t.eventId),r[0])})},function(e){return t.forEach(t.db.table(202).fetch(),function(e){var t=e.item;return r[2]=(r[0].push(t.eventId),r[0])})},function(e){return t.forEach(t.db.table(238).fetch(),function(e){var t=e.item;return r[2]=(r[0].push(t.eventId),r[0])})},function(e){return t.sequence([function(e){return r[2]=t.createArray(),r[3]=t.i64.of_int32(r[0].length),t.i64.gt(r[3],t.i64.cast([0,0]))?t.loopAsync(r[3],function(e){return r[5]=e,t.sequence([function(e){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),r[0],r[5]).then(function(e){var t;return t=e,r[6]=t[0],r[7]=t[1],t})},function(e){return r[8]=(r[2].push(t.i64.to_string(r[6])),r[2])}])}):t.resolve()},function(e){return r[4]=r[2].join(","),r[1]=r[4]}])},function(e){return t.forEach(t.filter(t.db.table(200).fetch(),function(e){return r[0].some(function(n){return t.i64.eq(e.eventId,n)})}),function(e){return e.delete()})},function(e){return t.forEach(t.db.table(202).fetch(),function(e){return e.delete()})},function(e){return t.forEach(t.db.table(201).fetch(),function(e){return e.delete()})},function(e){return t.forEach(t.db.table(238).fetch(),function(e){return e.delete()})}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSOmnistoreSettingsDeleteAllCmFbEventDataStoredProcedure",e.__tables__=["cm_channel_events","community_events","audio_channel_events","fb_events"],a.exports=e}),null);
__d("LSDeleteCommunityUnjoinedChannel",[],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],n=[],r=[];return t.sequence([function(n){return t.forEach(t.filter(t.db.table(9).fetch([[[e[0]]]]),function(n){return t.i64.eq(n.threadKey,e[0])&&[t.i64.cast([0,19]),t.i64.cast([0,28])].some(function(e){return t.i64.eq(n.threadType,e)})}),function(e){return e.delete()})},function(e){return t.resolve(r)}])}e.__sproc_name__="LSMailboxDeleteCommunityUnjoinedChannelStoredProcedure",e.__tables__=["threads"],a.exports=e}),null);
__d("LSDeleteThenInsertCmCategoryList",[],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],n=[],r=[];return t.sequence([function(n){return t.db.table(182).put({communityId:e[0],categoryId:e[1],categoryName:e[2],categoryRank:e[3],categoryType:e[4],display:e[5]})},function(e){return t.resolve(r)}])}e.__sproc_name__="LSOmnistoreSettingsDeleteThenInsertCmCategoryListStoredProcedure",e.__tables__=["cm_category_list"],a.exports=e}),null);
__d("LSDeleteThenInsertCmChannelEvent",[],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],n=[],r=[];return t.sequence([function(n){return t.db.table(201).put({eventId:e[0],threadId:e[1]})},function(e){return t.resolve(r)}])}e.__sproc_name__="LSOmnistoreSettingsDeleteThenInsertCmChannelEventStoredProcedure",e.__tables__=["cm_channel_events"],a.exports=e}),null);
__d("LSDeleteThenInsertCommunityChannelCategory",[],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],n=[],r=[];return t.sequence([function(r){return n[1]="community",t.db.table(9).fetch([[[e[0]]]]).next().then(function(r,o){var a,i,l=r.done,s=r.value;return l?t.db.table(9).put({threadKey:e[0],parentThreadKey:e[1],mailboxType:t.i64.cast([0,0]),threadType:t.i64.cast([0,20]),threadName:e[2],folderName:n[1],authorityLevel:e[3],lastActivityTimestampMs:e[4],lastReadWatermarkTimestampMs:e[4],removeWatermarkTimestampMs:t.i64.cast([-1,4294967295]),ongoingCallState:t.i64.cast([0,0])}):(o=s.item,n[2]=o.lastActivityTimestampMs,n[4]=o.parentThreadKey,n[3]=o.disappearingThreadKey,n[5]=o.isDisappearingMode,t.i64.le(o.authorityLevel,e[3])?t.i64.gt(n[2],e[4])&&t.i64.neq(n[3],void 0)?(t.i64.eq(e[1],t.i64.cast([-1,4294967286]))&&t.i64.eq(n[4],t.i64.cast([0,0]))?(a=[n[4],o.folderName],n[6]=a[0],n[7]=a[1]):(i=[e[1],n[1]],n[6]=i[0],n[7]=i[1]),t.db.table(9).put({threadKey:e[0],parentThreadKey:n[6],mailboxType:t.i64.cast([0,0]),threadType:t.i64.cast([0,20]),threadName:e[2],folderName:n[7],authorityLevel:e[3],lastActivityTimestampMs:n[2],lastReadWatermarkTimestampMs:o.lastReadWatermarkTimestampMs,removeWatermarkTimestampMs:t.i64.cast([-1,4294967295]),ongoingCallState:t.i64.cast([0,0]),disappearingThreadKey:n[3],isDisappearingMode:n[5]})):t.db.table(9).put({threadKey:e[0],parentThreadKey:e[1],mailboxType:t.i64.cast([0,0]),threadType:t.i64.cast([0,20]),threadName:e[2],folderName:n[1],authorityLevel:e[3],lastActivityTimestampMs:e[4],lastReadWatermarkTimestampMs:e[4],removeWatermarkTimestampMs:t.i64.cast([-1,4294967295]),ongoingCallState:t.i64.cast([0,0]),disappearingThreadKey:n[3],isDisappearingMode:n[5]}):t.resolve())})},function(e){return t.resolve(r)}])}e.__sproc_name__="LSMailboxDeleteThenInsertCommunityChannelCategoryStoredProcedure",e.__tables__=["threads"],a.exports=e}),null);
__d("LSDeleteThenInsertCommunityEventsV2",[],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],n=[],r=[];return t.resolve(r)}e.__sproc_name__="LSOmnistoreSettingsDeleteThenInsertCommunityEventsV2StoredProcedure",e.__tables__=[],a.exports=e}),null);
__d("LSDeleteThenInsertFbEvent",[],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],n=[],r=[];return t.sequence([function(n){return t.db.table(200).put({eventId:e[0],eventName:e[3],eventPictureUrl:e[5],numGoingUsers:e[8],numInterestedUsers:e[9],startTimeMs:e[1],endTimeMs:e[2],locationName:e[4],eventPictureUrlFallback:e[6],eventPictureUrlExpirationTimestampMs:e[7],rsvpStatus:e[10]})},function(e){return t.resolve(r)}])}e.__sproc_name__="LSOmnistoreSettingsDeleteThenInsertFbEventStoredProcedure",e.__tables__=["fb_events"],a.exports=e}),null);
__d("LSLazyMessageForcedFetch",["LSIssueNewTask"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(o){return t.db.table(12).fetch([[[e[0]]],"messageId"]).next().then(function(o,a){var i=o.done,l=o.value;return i?0:(a=l.item,t.sequence([function(e){return r[5]=a.threadKey,t.db.table(9).fetch([[[r[5]]]]).next().then(function(e,n){var o=e.done,a=e.value;return o?r[0]=t.i64.cast([0,1]):(n=a.item,r[7]=n.syncGroup,t.i64.neq(r[7],void 0)?r[6]=r[7]:r[6]=t.i64.cast([0,1]),r[0]=r[6])})},function(o){return r[2]=new t.Map,r[2].set("thread_key",r[5]),r[2].set("message_id",e[0]),r[2].set("sync_group",r[0]),r[3]=r[2].get("thread_key"),r[4]=t.toJSON(r[2]),t.storedProcedure(n("LSIssueNewTask"),t.i64.to_string(r[3]),t.i64.cast([0,19]),r[4],void 0,void 0,t.i64.cast([0,0]),t.i64.cast([0,0]),void 0,void 0,t.i64.cast([0,0]),t.i64.cast([0,0]))}]))})},function(e){return t.resolve(o)}])}e.__sproc_name__="LSMailboxLazyMessageForcedFetchStoredProcedure",e.__tables__=["messages","threads"],a.exports=e}),null);
__d("LSRefreshEventXMAsOnRSVP",["LSLazyMessageForcedFetch"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(r){return t.forEach(t.filter(t.db.table(16).fetch([[[e[1]]]]),function(n){return e[0]===n.attachmentFbid&&t.i64.eq(e[1],n.threadKey)}),function(e){var r=e.item;return t.storedProcedure(n("LSLazyMessageForcedFetch"),r.messageId,r.threadKey)})},function(e){return t.resolve(o)}])}e.__sproc_name__="LSMailboxRefreshEventXMAsOnRSVPStoredProcedure",e.__tables__=["attachments"],a.exports=e}),null);
__d("LSSetNeedsAdminApprovalForNewParticipant",[],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],n=[],r=[];return t.sequence([function(n){return t.forEach(t.db.table(9).fetch([[[e[0]]]]),function(t){var n=t.update,r=t.item;return n({needsAdminApprovalForNewParticipant:e[1]})})},function(e){return t.resolve(r)}])}e.__sproc_name__="LSMailboxSetNeedsAdminApprovalForNewParticipantStoredProcedure",e.__tables__=["threads"],a.exports=e}),null);
__d("LSSetSecondaryParentThreadKey",[],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],n=[],r=[];return t.sequence([function(n){return t.forEach(t.db.table(9).fetch([[[e[0]]]]),function(t){var n=t.update,r=t.item;return n({secondaryParentThreadKey:e[1]})})},function(e){return t.resolve(r)}])}e.__sproc_name__="LSMailboxSetSecondaryParentThreadKeyStoredProcedure",e.__tables__=["threads"],a.exports=e}),null);
__d("LSUpdateCommunityChannelSortOrderOverride",[],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],n=[],r=[];return t.resolve(r)}e.__sproc_name__="LSMailboxUpdateCommunityChannelSortOrderOverrideStoredProcedure",e.__tables__=[],a.exports=e}),null);
__d("LSUpdateThreadJoinRequestApprovalSetting",[],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],n=[],r=[];return t.sequence([function(n){return t.forEach(t.db.table(9).fetch([[[e[0]]]]),function(t){var n=t.update,r=t.item;return n({joinRequestApprovalSetting:e[1]})})},function(e){return t.resolve(r)}])}e.__sproc_name__="LSMailboxUpdateThreadJoinRequestApprovalSettingStoredProcedure",e.__tables__=["threads"],a.exports=e}),null);